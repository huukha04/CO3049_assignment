<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Mazer Admin Dashboard</title>
    
    
    
	<link rel="stylesheet" href="<?=DIST?>assets/compiled/css/app.css">
	<link rel="stylesheet" href="<?=DIST?>assets/compiled/css/app-dark.css">
	<link rel="stylesheet" href="<?=DIST?>assets/compiled/css/iconly.css">

	<style>
		.col-md-3 .card {
			aspect-ratio: 2 / 3;
			background: #ddd;
			display: flex;
			justify-content: center;
			align-items: center;
		}
	</style>
	
</head>

<body>
	<script src="<?=DIST?>assets/static/js/initTheme.js"></script>
    <div id="app">
		<!--  -->
		<?php include 'sidebar.php'; ?>
		<!--  -->
		<div id="main">
			<div class="container-xxl">
				<header class="navbar mb-3">
					<a href="#" class="burger-btn d-block d-xl-none">
						<i class="bi bi-justify fs-3"></i>
					</a>
					<div class="logo fs-1">
						<a href="<?=ROOT?>home">Move</a>
					</div>
				
					<!--  -->
					<?php include 'dropdown.php'; ?>
				</header>
				
				
				<div class="page-heading">
				</div> 
				
				<div class="page-content mb-5 "> 
					<div class="card" >
						<div class="row">
							<div id="carouselExampleIndicators" class="carousel slide mx-auto w-100 ">
								<div class="carousel-indicators">
									<?php $i = 0; foreach ($poster as $p): ?>
										<?php if ($p->status === 'active'): ?>
											<button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="<?= $i ?>" class="<?= $i === 0 ? 'active' : '' ?>" aria-label="Slide <?= $i + 1 ?>"></button>
											<?php $i++; ?>
										<?php endif; ?>
									<?php endforeach; ?>
								</div>
								<div class="carousel-inner">
									<?php $i = 0; foreach ($poster as $p): ?>
										<?php if ($p->status === 'active'): ?>
											<div class="carousel-item <?= $i === 0 ? 'active' : '' ?> ratio ratio-21x9">
												<img src="<?= $p->url ?>" class="w-100 h-100" alt="Poster">
											</div>
											<?php $i++; ?>
										<?php endif; ?>
									<?php endforeach; ?>
								</div>
								<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
									<span class="carousel-control-prev-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Previous</span>
								</button>
								<button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Next</span>
								</button>
							</div>
							
						</div>
					</div>

					<!--  -->
					<div class="card">
						<div class="card-header fs-3">
							Phim đang chiếu
						</div>
						<div class="row">
							<div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
								<div class="carousel-inner">
									<?php 
									// Lọc danh sách phim chỉ lấy những phim có status "active"
									$activeMovie = array_filter($movie, function($movie) {
										return $movie->status === "active";
									});
					
									// Chia thành các nhóm 4 phim để hiển thị theo slide
									$chunks = array_chunk($activeMovie, 4); 
									$first = true;
					
									foreach ($chunks as $movieGroup): ?>
										<div class="carousel-item <?= $first ? 'active' : '' ?>">
											<div class="row px-5">
												<?php foreach ($movieGroup as $movie): ?>
													<div class="col-md-3">
														<div class="card border">
															<img src="<?= htmlspecialchars($movie->url); ?>" class="card-img-top" alt="Movie Image">
														</div>          
													</div>
												<?php endforeach; ?>
											</div>
										</div>
									<?php 
									$first = false;
									endforeach; 
									?>
								</div>
								<!-- Controls -->
								<button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
									<span class="carousel-control-prev-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Previous</span>
								</button>
								<button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Next</span>
								</button>
							</div>
						</div>
					</div>
					
					<!--  -->
					<div class="card">

					</div>	
					
				</div>
			</div>

			<?php include 'footer.php'; ?>

        </div>
    </div>
    <script src="<?=DIST?>assets/static/js/components/dark.js"></script>
    <script src="<?=DIST?>assets/extensions/perfect-scrollbar/perfect-scrollbar.min.js"></script>
    <script src="<?=DIST?>assets/compiled/js/app.js"></script>
    

    
	<!-- Need: Apexcharts -->
	<script src="<?=DIST?>assets/extensions/apexcharts/apexcharts.min.js"></script>
	<script src="<?=DIST?>assets/static/js/pages/dashboard.js"></script>
    
    

</body>

</html>